
{% extends 'includes/layout.html' %}
{% load static %}
{% block content %} 
<main class="d-flex w-100">
	<div class="container d-flex flex-column">
		<div class="row vh-100">
			<div class="col-sm-10 col-md-8 col-lg-6 mx-auto d-table h-100">
				<div class="d-table-cell align-middle">

					<div class="text-center mt-4">
						<h1 class="h2">Create Employee</h1> 
					</div>

					<div class="card">
						<div class="card-body">
							<div class="m-sm-4"> 
									<div class="mb-3">
										<label class="form-label">Employee Name</label>
										<input class="form-control form-control-lg" type="text" name="name" id="name" placeholder="Enter Employee Full Name" />
									</div> 
                                    <div class="mb-3">
										<label class="form-label">NIC</label>
										<input class="form-control form-control-lg" type="text" name="nic" id="nic" placeholder="Enter NIC Number" />
									</div> 
                                    <div class="mb-3">
										<label class="form-label">Date of Birth</label>
										<input class="form-control form-control-lg" type="date" name="dob" id="dob" placeholder="Enter Date of Birth" />
									</div> 
                                    <div class="mb-3">
										<label class="form-label">Gender</label> 
										<select class="form-control form-control-lg" name="gender" id="gender"> 
											<option value="M">Male</option>
											<option value="F">Female</option> 
									   </select>
									</div> 
                                    <div class="mb-3">
										<label class="form-label">Maritial  Status</label>
										<input class="form-control form-control-lg" type="text" name="status" id="status" placeholder="Enter Employee Status" />
									</div> 
									<div class="form-group">
										<label for="form-label">Employee Image</label>
										<input type="file" class="form-control form-control-lg form-control-file" id="image" accept="image/*">
									</div>

									<div class="text-center m-4">
										<h1 class="h4">Contact Details</h1>  
									</div>
                                    <div class="mb-3">
										<label class="form-label">Address</label>
										<input class="form-control form-control-lg" type="text" name="address" id="address" placeholder="Enter Employee Address" />
									</div> 
                                    <div class="mb-3">
										<label class="form-label">Mobile Number</label>
										<input class="form-control form-control-lg" type="text" name="mobile" id="mobile" placeholder="Enter Mobile Number" />
									</div>  
                                    <div class="text-center m-4">
										<h1 class="h4">Bank Details (To remit the salary)</h1>  
									</div>
                                    <div class="mb-3">
										<label class="form-label">Bank Name</label>
										<input class="form-control form-control-lg" type="text" name="bank" id="bank" placeholder="Enter Bank Name" />
									</div> 
                                    <div class="mb-3">
										<label class="form-label">Branch</label>
										<input class="form-control form-control-lg" type="text" name="branch" id="branch" placeholder="Enter Branch Name" />
									</div> 
                                    <div class="mb-3">
										<label class="form-label">Account Number</label>
										<input class="form-control form-control-lg" type="text" name="account" id="account" placeholder="Enter Account Number" />
									</div> 

                                    <div class="text-center m-4">
										<h1 class="h4">Payroll Information</h1>  
									</div>
                                    <div class="mb-3">
										<label class="form-label">EPF Number</label>
										<input class="form-control form-control-lg" type="text" name="epf" id="epf" placeholder="Enter EPF Number" />
									</div> 
                                    <div class="mb-3">
										<label class="form-label">Date of Appointment</label>
										<input class="form-control form-control-lg" type="date" name="appointmentDate" id="appointmentDate" placeholder="Enter Date of Appointment" />
									</div>
                                    <div class="mb-3">
										<label class="form-label">Job Title</label> 
										<select class="form-control form-control-lg" name="job" id="job"> 
											{% for role in roles %}
											<option value="{{role.id}}">{{role.name}}</option> 
											{% endfor %}
									   </select>
									</div>
                                    <div class="mb-3">
										<label class="form-label">Basic Salary</label>
										<input class="form-control form-control-lg" type="number" name="basicSalary" id="basicSalary" placeholder="Enter Basic Salary" />
									</div>
                                    <div class="mb-3">
										<label class="form-label">Allowances</label>
										<input class="form-control form-control-lg" type="number" name="allowance" id="allowance" placeholder="Enter Allowance" />
									</div> 
                                    <div class="text-center mt-3"> 
										<button class="btn btn-primary w-100" onclick="createEmployee()" id="submitInvoice">Create Employee</button> 
									</div>  
							</div>
						</div>
					</div>

				</div>
			</div>
		</div>
	</div>
</main> 
<script> 
	function createEmployee(){ 
		var name = $('#name').val();
		var nic = $('#nic').val();  
		var dob = $('#dob').val();  
		var gender = $('#gender').val();  
		var status = $('#status').val(); 
		var image = $('#image')[0].files[0];
		var address = $('#address').val();
		var mobile = $('#mobile').val();
		var bank = $('#bank').val(); 
		var branch= $('#branch').val(); 
		var account = $('#account').val();
		var epf = $('#epf').val();  
		var appointmentDate = $('#appointmentDate').val(); 
		var job = $("#job").val();
		var basicSalary = $("#basicSalary").val();
		var allowance = $("#allowance").val();

		if(name!='' && nic!='' && dob!='' && status!='' && image!='' && address!='' && mobile!='' && bank!='' && branch!='' && account!='' && epf!='' && appointmentDate!='' && basicSalary!='' && allowance!='')

		var fd = new FormData();
		fd.append('name',name); 
		fd.append('nic',nic); 
		fd.append('dob',dob); 
		fd.append('status',status); 
		fd.append('gender',gender); 
		fd.append('image',image); 
		fd.append('address',address); 
		fd.append('mobile',mobile); 
		fd.append('bank',bank); 
		fd.append('branch',branch); 
		fd.append('account',account); 
		fd.append('epf',epf); 
		fd.append('appointmentDate',appointmentDate); 
		fd.append('job',job); 
		fd.append('basicSalary',basicSalary); 
		fd.append('allowance',allowance); 

		$.ajax({
			url:"api/v1/insert-employee",
			type:"POST",
			headers:{
				"X-CSRFToken":'{{csrf_token}}'
			},
			mode:"same-origin",
			data:fd,
			contentType: false,
			dataType: "json",
			processData: false,
			success:function(response){   
				console.log('success')
			}
		})
	}
</script>
{% endblock %}