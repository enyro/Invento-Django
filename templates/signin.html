{% extends 'includes/layout.html' %}
{% load static %}
{% block content %} 
<main class="d-flex w-100">
    <div class="container d-flex flex-column">
        <div class="row vh-100">
            <div class="col-sm-10 col-md-8 col-lg-6 mx-auto d-table h-100">
                <div class="d-table-cell align-middle">

                    <div class="text-center mt-4">
                        <!-- <h1 class="h2">Welcome back,</h1> -->
                        <p class="lead">
                            Sign in to your account to continue
                        </p>
                    </div>

                    <div class="card">
                        <div class="card-body">
                            <div class="m-sm-4">
                                <div class="text-center"> 
                                </div>  
                                <div class="alert alert-danger" id="alert" role="alert"> 
                                </div>
                                    <div class="mb-3">
                                        <label class="form-label">Username</label>
                                        <input class="form-control form-control-lg" type="text" id="username" name="username" placeholder="Enter your username" />
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Password</label>
                                        <input class="form-control form-control-lg" id="password" type="password" name="password" placeholder="Enter your password" />
                                    </div> 
                                    <div class="text-center mt-3"> 
                                        <button onclick="login()" class="btn btn-lg btn-primary" id="signin">Sign in</button>
                                    </div> 
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</main> 
<script>
    $('#alert').hide();
    function login(){
        $('#alert').hide();
        username = $("#username").val();
        password = $("#password").val();
        console.log(username + password)
        $.ajax({
            url: "api/v1/signin",
            type: "POST",
            headers: {
                "X-CSRFToken": '{{csrf_token}}'
            },
            mode: "same-origin",
            data: {
                username: username,
                password: password
            },
            dataType: "json",
            success: function (response) { 
                console.log(response.data)
                if(response.id == 200){
                    window.location.replace("/")
                }else{
                    $("#alert").html(response.data);
                    $('#alert').show();
                }
            },
            error:function (response){
                console.log(response)
            }
        });
    }
</script>
{% endblock %}